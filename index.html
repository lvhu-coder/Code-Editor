<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Browser Codespace</title>
  <style>
    body, html { margin: 0; height: 100%; display: flex; flex-direction: column; }
    #editor { height: 70%; width: 100%; }
    #output { height: 30%; width: 100%; background: #1e1e1e; color: #c5c5c5; padding: 10px; overflow: auto; font-family: monospace; }
    button { margin: 5px; }
  </style>
  <!-- Monaco Editor CDN -->
  <script src="https://cdn.jsdelivr.net/npm/monaco-editor@0.38.0/min/vs/loader.js"></script>
  <!-- Pyodide CDN for Python -->
  <script src="https://cdn.jsdelivr.net/pyodide/v0.23.4/full/pyodide.js"></script>
</head>
<body>
  <div>
    <button onclick="runJS()">Run JS</button>
    <button onclick="runPython()">Run Python</button>
    <button onclick="saveFile()">Save File</button>
    <button onclick="loadFile()">Load File</button>
  </div>
  <div id="editor"></div>
  <div id="output">Output:</div>

  <script>
    let editor;
    let pyodide;

    // Load Monaco Editor
    require.config({ paths: { vs: 'https://cdn.jsdelivr.net/npm/monaco-editor@0.38.0/min/vs' }});
    require(['vs/editor/editor.main'], function () {
      editor = monaco.editor.create(document.getElementById('editor'), {
        value: '// Write JS or Python code here\n',
        language: 'javascript',
        theme: 'vs-dark',
        automaticLayout: true
      });
    });

    // Load Pyodide
    async function loadPyodideAndPackages() {
      pyodide = await loadPyodide();
      console.log('Pyodide loaded!');
    }
    loadPyodideAndPackages();

    function runJS() {
      const code = editor.getValue();
      try {
        const result = eval(code);
        document.getElementById('output').innerText = 'Output:\n' + result;
      } catch (err) {
        document.getElementById('output').innerText = 'Error:\n' + err;
      }
    }

    async function runPython() {
      const code = editor.getValue();
      if (!pyodide) {
        document.getElementById('output').innerText = 'Pyodide not loaded yet!';
        return;
      }
      try {
        const result = await pyodide.runPythonAsync(code);
        document.getElementById('output').innerText = 'Output:\n' + result;
      } catch (err) {
        document.getElementById('output').innerText = 'Error:\n' + err;
      }
    }

    // Save and load from localStorage
    function saveFile() {
      localStorage.setItem('code', editor.getValue());
      alert('File saved in browser storage!');
    }

    function loadFile() {
      const code = localStorage.getItem('code');
      if (code) {
        editor.setValue(code);
      } else {
        alert('No saved file found!');
      }
    }
  </script>
</body>
</html>
